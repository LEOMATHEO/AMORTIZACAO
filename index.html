<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Controle de Financiamento</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#1f6feb">
  <link rel="icon" href="icons/icon-192.png" sizes="192x192">
  <link rel="icon" href="icons/icon-512.png" sizes="512x512">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <h1>Controle de Financiamento</h1>

    <section class="panel">
      <div class="row wrap">
        <div><strong>Saldo:</strong> <span id="lblSaldo" class="badge">R$ 0,00</span></div>
        <div><strong>Meta:</strong> <span id="lblMeta" class="badge">60 meses</span></div>
        <div><strong>Sugerido (TOTAL do mês):</strong> <span id="lblSugerida" class="badge">R$ 0,00</span></div>
      </div>
      <div class="muted">
        O <b>Sugerido</b> é o valor total a pagar no mês (= Parcela + Extra).<br/>
        Extra = diferença para zerar em M meses com a taxa efetiva aproximada.
      </div>
    </section>

    <section class="grid">
      <div>
        <label>Saldo Devedor Atual (R$)</label>
        <input id="inpSaldo" class="input" inputmode="decimal" />
      </div>
      <div>
        <label>Parcela Mensal Atual (R$)</label>
        <input id="inpParcela" class="input" inputmode="decimal" />
      </div>
      <div>
        <label>Meta de Liquidação (meses)</label>
        <input id="inpMeses" class="input" inputmode="numeric" />
      </div>
      <div>
        <label>Índice de Correção Mensal (TR) (ex.: 0,003 = 0,3%)</label>
        <input id="inpIndice" class="input" inputmode="decimal" />
      </div>
      <div>
        <label>Juros Efetivos Mensais (ex.: 0,0075 = 0,75%)</label>
        <input id="inpJuros" class="input" inputmode="decimal" />
      </div>
      <div>
        <label>Amortização Extra do Mês (R$)</label>
        <input id="inpExtra" class="input" inputmode="decimal" />
      </div>
    </section>

    <div class="row">
      <button id="btnConfirmar" class="btn">Confirmar Pagamento</button>
      <button id="btnExportar" class="btn secondary">Exportar CSV</button>
      <button id="btnLimpar" class="btn secondary">Limpar histórico</button>
      <button id="btnReset" class="btn secondary">Restaurar padrão</button>
    </div>

    <section class="panel" style="margin-top:16px">
      <div class="row" style="gap: 24px;">
        <div>Parcela atual: <span id="lblParcela" class="badge">R$ 0,00</span></div>
        <div>Extra sugerido: <span id="lblExtra" class="badge">R$ 0,00</span></div>
      </div>
    </section>

    <section class="panel" style="margin-top:16px">
      <table class="table" id="tbl">
        <thead>
          <tr>
            <th>Data</th>
            <th>Parcela</th>
            <th>Extra Pago</th>
            <th>i_mensal(%)</th>
            <th>Novo Saldo</th>
          </tr>
        </thead>
        <tbody id="tbody">
          <tr><td colspan="5">Nenhum pagamento lançado ainda.</td></tr>
        </tbody>
      </table>
    </section>

    <footer class="muted">
      Parcela ideal A = S * i_eff * (1+i_eff)^M / ((1+i_eff)^M - 1).<br/>
      <b>Extra sugerido</b> = max(0, A - parcela); <b>Sugerido (TOTAL)</b> = parcela + extra.<br/>
      i_eff ≈ juros_mensal + índice_mensal (aproximação prática).
    </footer>
  </div>

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => navigator.serviceWorker.register('./sw.js'));
    }
  </script>
  <script src="script.js"></script>
</body>
</html>
